<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>super_gradients.training.datasets.dataset_interfaces.dataset_interface &mdash; SuperGradients 1.0 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../../index.html" class="icon icon-home"> SuperGradients
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Welcome To SuperGradients</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../welcome.html">Fill our 4-question quick survey! We will raffle free SuperGradients swag between those who will participate -&gt; Fill Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../welcome.html#supergradients">SuperGradients</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../super_gradients.common.html">Common package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../super_gradients.training.html">Training package</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html">What is SuperGradients?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#introducing-the-supergradients-library">Introducing the SuperGradients library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#integrating-your-training-code-complete-walkthrough">Integrating Your Training Code - Complete Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#training-parameters">Training Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#logs-and-checkpoints">Logs and Checkpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#dataset-parameters">Dataset Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#network-architectures">Network Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#pretrained-models">Pretrained Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#how-to-reproduce-our-training-recipes">How To Reproduce Our Training Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#professional-tools-integration">Professional Tools Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html#supergradients-faq">SuperGradients FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">SuperGradients</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
      <li>super_gradients.training.datasets.dataset_interfaces.dataset_interface</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for super_gradients.training.datasets.dataset_interfaces.dataset_interface</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.datasets</span> <span class="k">as</span> <span class="nn">datasets</span>
<span class="kn">from</span> <span class="nn">torch.utils.data.distributed</span> <span class="kn">import</span> <span class="n">DistributedSampler</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">ConcatDataset</span><span class="p">,</span> <span class="n">BatchSampler</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>


<span class="kn">from</span> <span class="nn">super_gradients.common</span> <span class="kn">import</span> <span class="n">DatasetDataInterface</span>
<span class="kn">from</span> <span class="nn">super_gradients.common.environment</span> <span class="kn">import</span> <span class="n">AWS_ENV_NAME</span>
<span class="kn">from</span> <span class="nn">super_gradients.common.abstractions.abstract_logger</span> <span class="kn">import</span> <span class="n">get_logger</span>

<span class="kn">from</span> <span class="nn">super_gradients.training</span> <span class="kn">import</span> <span class="n">utils</span> <span class="k">as</span> <span class="n">core_utils</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.utils.distributed_training_utils</span> <span class="kn">import</span> <span class="n">get_local_rank</span><span class="p">,</span> <span class="n">wait_for_the_master</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.utils</span> <span class="kn">import</span> <span class="n">get_param</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.utils.detection_utils</span> <span class="kn">import</span> <span class="n">DetectionTargetsFormat</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.datasets</span> <span class="kn">import</span> <span class="n">datasets_utils</span><span class="p">,</span> <span class="n">DataAugmentation</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.datasets_conf</span> <span class="kn">import</span> <span class="n">COCO_DETECTION_CLASSES_LIST</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.data_augmentation</span> <span class="kn">import</span> <span class="n">Lighting</span><span class="p">,</span> <span class="n">RandomErase</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.mixup</span> <span class="kn">import</span> <span class="n">CollateMixup</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.detection_datasets</span> <span class="kn">import</span> <span class="n">COCODetectionDataset</span><span class="p">,</span> <span class="n">PascalVOCDetectionDataset</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.samplers.infinite_sampler</span> <span class="kn">import</span> <span class="n">InfiniteSampler</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.segmentation_datasets</span> <span class="kn">import</span> <span class="n">PascalVOC2012SegmentationDataSet</span><span class="p">,</span> \
    <span class="n">PascalAUG2012SegmentationDataSet</span><span class="p">,</span> <span class="n">CoCoSegmentationDataSet</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.segmentation_datasets.cityscape_segmentation</span> <span class="kn">import</span> <span class="n">CityscapesDataset</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.segmentation_datasets.supervisely_persons_segmentation</span> <span class="kn">import</span> \
    <span class="n">SuperviselyPersonsDataset</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.samplers.repeated_augmentation_sampler</span> <span class="kn">import</span> <span class="n">RepeatAugSampler</span>
<span class="kn">from</span> <span class="nn">super_gradients.training.datasets.datasets_utils</span> <span class="kn">import</span> <span class="n">RandomResizedCropAndInterpolation</span><span class="p">,</span> <span class="n">worker_init_reset_seed</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.transforms.transforms</span> <span class="kn">import</span> <span class="n">DetectionMosaic</span><span class="p">,</span> <span class="n">DetectionMixup</span><span class="p">,</span> <span class="n">DetectionRandomAffine</span><span class="p">,</span>\
    <span class="n">DetectionTargetsFormatTransform</span><span class="p">,</span> <span class="n">DetectionPaddedRescale</span><span class="p">,</span> <span class="n">DetectionHSV</span><span class="p">,</span> <span class="n">DetectionHorizontalFlip</span>

<span class="kn">from</span> <span class="nn">super_gradients.training.exceptions.dataset_exceptions</span> <span class="kn">import</span> <span class="n">IllegalDatasetParameterException</span>


<span class="n">default_dataset_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s2">&quot;val_batch_size&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;test_batch_size&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;dataset_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;./data/&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;s3_link&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">LIBRARY_DATASETS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cifar10&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.4914</span><span class="p">,</span> <span class="mf">0.4822</span><span class="p">,</span> <span class="mf">0.4465</span><span class="p">),</span> <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.2023</span><span class="p">,</span> <span class="mf">0.1994</span><span class="p">,</span> <span class="mf">0.2010</span><span class="p">)},</span>
    <span class="s2">&quot;cifar100&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR100</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5071</span><span class="p">,</span> <span class="mf">0.4865</span><span class="p">,</span> <span class="mf">0.4409</span><span class="p">),</span> <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.2673</span><span class="p">,</span> <span class="mf">0.2564</span><span class="p">,</span> <span class="mf">0.2762</span><span class="p">)},</span>
    <span class="s2">&quot;SVHN&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">SVHN</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="DatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">DatasetInterface</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DatasetInterface - This class manages all of the &quot;communiation&quot; the Model has with the Data Sets</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">train_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @param train_loader: torch.utils.data.Dataloader (optional) dataloader for training.</span>
<span class="sd">        @param test_loader: torch.utils.data.Dataloader (optional) dataloader for testing.</span>
<span class="sd">        @param classes: list of classes.</span>

<span class="sd">        Note: the above parameters will be discarded in case dataset_params is passed.</span>

<span class="sd">        @param dataset_params:</span>

<span class="sd">            - `batch_size` : int (default=64)</span>

<span class="sd">                Number of examples per batch for training. Large batch sizes are recommended.</span>

<span class="sd">            - `val_batch_size` : int (default=200)</span>

<span class="sd">                Number of examples per batch for validation. Large batch sizes are recommended.</span>

<span class="sd">            - `dataset_dir` : str (default=&quot;./data/&quot;)</span>

<span class="sd">                Directory location for the data. Data will be downloaded to this directory when getting it from a</span>
<span class="sd">                remote url.</span>

<span class="sd">            - `s3_link` : str (default=None)</span>

<span class="sd">                remote s3 link to download the data (optional).</span>

<span class="sd">            - `aug_repeat_count` : int (default=0)</span>

<span class="sd">                amount of repetitions (each repetition of an example is augmented differently) for each</span>
<span class="sd">                 example for the trainset.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">HpmStruct</span><span class="p">(</span><span class="o">**</span><span class="n">default_dataset_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span> <span class="o">=</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">,</span> <span class="n">test_loader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">s3_link</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_from_cloud</span><span class="p">()</span>

<div class="viewcode-block" id="DatasetInterface.download_from_cloud"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.download_from_cloud">[docs]</a>    <span class="k">def</span> <span class="nf">download_from_cloud</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">s3_link</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">env_name</span> <span class="o">=</span> <span class="n">AWS_ENV_NAME</span>
            <span class="n">downloader</span> <span class="o">=</span> <span class="n">DatasetDataInterface</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env_name</span><span class="p">)</span>
            <span class="n">target_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">dataset_dir</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">target_dir</span><span class="p">)</span>
            <span class="n">downloader</span><span class="o">.</span><span class="n">load_remote_dataset_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">s3_link</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">)</span></div>

<div class="viewcode-block" id="DatasetInterface.build_data_loaders"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.build_data_loaders">[docs]</a>    <span class="k">def</span> <span class="nf">build_data_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">test_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed_sampler</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        define train, val (and optionally test) loaders. The method deals separately with distributed training and standard</span>
<span class="sd">        (non distributed, or parallel training). In the case of distributed training we need to rely on distributed</span>
<span class="sd">        samplers.</span>
<span class="sd">        :param batch_size_factor: int - factor to multiply the batch size (usually for multi gpu)</span>
<span class="sd">        :param num_workers: int - number of workers (parallel processes) for dataloaders</span>
<span class="sd">        :param train_batch_size: int - batch size for train loader, if None will be taken from dataset_params</span>
<span class="sd">        :param val_batch_size: int - batch size for val loader, if None will be taken from dataset_params</span>
<span class="sd">        :param distributed_sampler: boolean flag for distributed training mode</span>
<span class="sd">        :return: train_loader, val_loader, classes: list of classes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># CHANGE THE BATCH SIZE ACCORDING TO THE NUMBER OF DEVICES - ONLY IN NON-DISTRIBUTED TRAINING MODE</span>
        <span class="c1"># IN DISTRIBUTED MODE WE NEED DISTRIBUTED SAMPLERS</span>
        <span class="c1"># NO SHUFFLE IN DISTRIBUTED TRAINING</span>

        <span class="n">aug_repeat_count</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;aug_repeat_count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aug_repeat_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">distributed_sampler</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IllegalDatasetParameterException</span><span class="p">(</span><span class="s2">&quot;repeated augmentation is only supported with DDP.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">distributed_sampler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">train_sampler</span> <span class="o">=</span> <span class="n">RepeatAugSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span>
                                             <span class="n">num_repeats</span><span class="o">=</span><span class="n">aug_repeat_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">aug_repeat_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">DistributedSampler</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">)</span>
            <span class="n">val_sampler</span> <span class="o">=</span> <span class="n">DistributedSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">)</span>
            <span class="n">test_sampler</span> <span class="o">=</span> <span class="n">DistributedSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testset</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">train_shuffle</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span> <span class="o">=</span> <span class="n">batch_size_factor</span>
            <span class="n">train_sampler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">val_sampler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">test_sampler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">train_shuffle</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">train_batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">train_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span>
        <span class="k">if</span> <span class="n">val_batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span>
        <span class="k">if</span> <span class="n">test_batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">test_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">test_batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span>

        <span class="n">train_loader_drop_last</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;train_loader_drop_last&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">cutmix</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;cutmix&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">cutmix_params</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;cutmix_params&#39;</span><span class="p">)</span>

        <span class="c1"># WRAPPING collate_fn</span>
        <span class="n">train_collate_fn</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span> <span class="s1">&#39;collate_fn&#39;</span><span class="p">)</span>
        <span class="n">val_collate_fn</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">,</span> <span class="s1">&#39;collate_fn&#39;</span><span class="p">)</span>
        <span class="n">test_collate_fn</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testset</span><span class="p">,</span> <span class="s1">&#39;collate_fn&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cutmix</span> <span class="ow">and</span> <span class="n">train_collate_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IllegalDatasetParameterException</span><span class="p">(</span><span class="s2">&quot;cutmix and collate function cannot be used together&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cutmix</span><span class="p">:</span>
            <span class="c1"># FIXME - cutmix should be available only in classification dataset. once we make sure all classification</span>
            <span class="c1"># datasets inherit from the same super class, we should move cutmix code to that class</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cutmix/mixup was enabled. This feature is currently supported only &quot;</span>
                           <span class="s2">&quot;for classification datasets.&quot;</span><span class="p">)</span>
            <span class="n">train_collate_fn</span> <span class="o">=</span> <span class="n">CollateMixup</span><span class="p">(</span><span class="o">**</span><span class="n">cutmix_params</span><span class="p">)</span>

        <span class="c1"># FIXME - UNDERSTAND IF THE num_replicas VARIBALE IS NEEDED</span>
        <span class="c1"># train_sampler = DistributedSampler(self.trainset,</span>
        <span class="c1">#                                    num_replicas=distributed_gpus_num) if distributed_sampler else None</span>
        <span class="c1"># val_sampler = DistributedSampler(self.valset,</span>
        <span class="c1">#                                   num_replicas=distributed_gpus_num) if distributed_sampler else None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span>
                                                        <span class="n">batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span>
                                                        <span class="n">shuffle</span><span class="o">=</span><span class="n">train_shuffle</span><span class="p">,</span>
                                                        <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                        <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                        <span class="n">sampler</span><span class="o">=</span><span class="n">train_sampler</span><span class="p">,</span>
                                                        <span class="n">collate_fn</span><span class="o">=</span><span class="n">train_collate_fn</span><span class="p">,</span>
                                                        <span class="n">drop_last</span><span class="o">=</span><span class="n">train_loader_drop_last</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">,</span>
                                                      <span class="n">batch_size</span><span class="o">=</span><span class="n">val_batch_size</span><span class="p">,</span>
                                                      <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                      <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                      <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                      <span class="n">sampler</span><span class="o">=</span><span class="n">val_sampler</span><span class="p">,</span>
                                                      <span class="n">collate_fn</span><span class="o">=</span><span class="n">val_collate_fn</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testset</span><span class="p">,</span>
                                                           <span class="n">batch_size</span><span class="o">=</span><span class="n">test_batch_size</span><span class="p">,</span>
                                                           <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                           <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                           <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                           <span class="n">sampler</span><span class="o">=</span><span class="n">test_sampler</span><span class="p">,</span>
                                                           <span class="n">collate_fn</span><span class="o">=</span><span class="n">test_collate_fn</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>

<div class="viewcode-block" id="DatasetInterface.get_data_loaders"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.get_data_loaders">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get self.train_loader, self.val_loader, self.test_loader, self.classes.</span>

<span class="sd">        If the data loaders haven&#39;t been initialized yet, build them first.</span>

<span class="sd">        :param kwargs: kwargs are passed to build_data_loaders.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build_data_loaders</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span></div>

<div class="viewcode-block" id="DatasetInterface.get_val_sample"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.get_val_sample">[docs]</a>    <span class="k">def</span> <span class="nf">get_val_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num_samples</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Tried to load more samples than val-set size&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_samples</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_samples</span><span class="p">]</span></div>

<div class="viewcode-block" id="DatasetInterface.get_dataset_params"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.get_dataset_params">[docs]</a>    <span class="k">def</span> <span class="nf">get_dataset_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span></div>

<div class="viewcode-block" id="DatasetInterface.print_dataset_details"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DatasetInterface.print_dataset_details">[docs]</a>    <span class="k">def</span> <span class="nf">print_dataset_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> training samples, </span><span class="si">{}</span><span class="s2"> val samples, </span><span class="si">{}</span><span class="s2"> classes&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">),</span>
                                                                             <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span><span class="p">)))</span></div></div>


<div class="viewcode-block" id="ExternalDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.ExternalDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">ExternalDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ExternalDatasetInterface - A wrapper for external dataset interface that gets dataloaders from keras/TF</span>
<span class="sd">        and converts them to Torch-like dataloaders that return torch.Tensors after</span>
<span class="sd">        optional collate_fn while maintaining the same interface (connect_dataset_interface etc.)</span>
<span class="sd">            :train_loader:       The external train_loader</span>
<span class="sd">            :val_loader:        The external val_loader</span>
<span class="sd">            :num_classes:        The number of classes</span>
<span class="sd">            :dataset_params      The dict that includes the batch_size and/or the collate_fn</span>

<span class="sd">            :return:             DataLoaders that generate torch.Tensors batches after collate_fn</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">train_loader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span> <span class="o">=</span> <span class="n">val_loader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">num_classes</span>

<div class="viewcode-block" id="ExternalDatasetInterface.get_data_loaders"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.ExternalDatasetInterface.get_data_loaders">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size_factor</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">val_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distributed_sampler</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="c1"># CHANGE THE BATCH SIZE ACCORDING TO THE NUMBER OF DEVICES - ONLY IN NON-DISTRIBUED TRAINING MODE</span>
        <span class="c1"># IN DISTRIBUTED MODE WE NEED DISTRIBUTED SAMPLERS</span>
        <span class="c1"># NO SHUFFLE IN DISTRIBUTED TRAINING</span>
        <span class="k">if</span> <span class="n">distributed_sampler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">train_sampler</span> <span class="o">=</span> <span class="n">DistributedSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">val_sampler</span> <span class="o">=</span> <span class="n">DistributedSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">)</span>
            <span class="n">train_shuffle</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span> <span class="o">=</span> <span class="n">batch_size_factor</span>
            <span class="n">train_sampler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">val_sampler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">train_shuffle</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">train_batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">train_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span>
        <span class="k">if</span> <span class="n">val_batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size_factor</span>

        <span class="n">train_loader_drop_last</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;train_loader_drop_last&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># WRAPPING collate_fn</span>
        <span class="n">train_collate_fn</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;train_collate_fn&#39;</span><span class="p">)</span>
        <span class="n">val_collate_fn</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;val_collate_fn&#39;</span><span class="p">)</span>

        <span class="c1"># FIXME - UNDERSTAND IF THE num_replicas VARIBALE IS NEEDED</span>
        <span class="c1"># train_sampler = DistributedSampler(self.trainset,</span>
        <span class="c1">#                                    num_replicas=distributed_gpus_num) if distributed_sampler else None</span>
        <span class="c1"># val_sampler = DistributedSampler(self.valset,</span>
        <span class="c1">#                                   num_replicas=distributed_gpus_num) if distributed_sampler else None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">torch_train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span><span class="p">,</span>
                                                              <span class="n">batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span>
                                                              <span class="n">shuffle</span><span class="o">=</span><span class="n">train_shuffle</span><span class="p">,</span>
                                                              <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                              <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                              <span class="n">sampler</span><span class="o">=</span><span class="n">train_sampler</span><span class="p">,</span>
                                                              <span class="n">collate_fn</span><span class="o">=</span><span class="n">train_collate_fn</span><span class="p">,</span>
                                                              <span class="n">drop_last</span><span class="o">=</span><span class="n">train_loader_drop_last</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">torch_val_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span><span class="p">,</span>
                                                            <span class="n">batch_size</span><span class="o">=</span><span class="n">val_batch_size</span><span class="p">,</span>
                                                            <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                            <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                            <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                            <span class="n">sampler</span><span class="o">=</span><span class="n">val_sampler</span><span class="p">,</span>
                                                            <span class="n">collate_fn</span><span class="o">=</span><span class="n">val_collate_fn</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">torch_train_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">torch_val_loader</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span></div></div>


<div class="viewcode-block" id="LibraryDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.LibraryDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">LibraryDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cifar10&quot;</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">to_cutout</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LibraryDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LIBRARY_DATASETS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;dataset not found&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span> <span class="o">=</span> <span class="n">LIBRARY_DATASETS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">SVHN</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datasets_utils</span><span class="o">.</span><span class="n">get_mean_and_std</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>

        <span class="c1"># OVERWRITE MEAN AND STD IF DEFINED IN DATASET PARAMS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_mean&#39;</span><span class="p">,</span>
                                                               <span class="n">default_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_std&#39;</span><span class="p">,</span>
                                                              <span class="n">default_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">])</span>

        <span class="n">crop_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;crop_size&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">to_cutout</span><span class="p">:</span>
            <span class="n">transform_train</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">crop_size</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
                <span class="n">DataAugmentation</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]),</span>
                <span class="n">DataAugmentation</span><span class="o">.</span><span class="n">cutout</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
                <span class="n">DataAugmentation</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">()</span>
            <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transform_train</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">crop_size</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]),</span>
            <span class="p">])</span>

        <span class="n">transform_val</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]),</span>
        <span class="p">])</span>
        <span class="n">dataset_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_dataset_params</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">dataset_cls</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">transform_train</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">dataset_cls</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">transform</span><span class="o">=</span><span class="n">transform_val</span><span class="p">)</span></div>


<div class="viewcode-block" id="Cifar10DatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.Cifar10DatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">Cifar10DatasetInterface</span><span class="p">(</span><span class="n">LibraryDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cifar10DatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;cifar10&quot;</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span></div>


<div class="viewcode-block" id="Cifar100DatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.Cifar100DatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">Cifar100DatasetInterface</span><span class="p">(</span><span class="n">LibraryDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cifar100DatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;cifar100&quot;</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.TestDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">TestDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TestDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">trainset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>

<div class="viewcode-block" id="TestDatasetInterface.get_data_loaders"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.TestDatasetInterface.get_data_loaders">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">distributed_sampler</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_data_loaders</span><span class="p">(</span><span class="n">batch_size_factor</span><span class="o">=</span><span class="n">batch_size_factor</span><span class="p">,</span>
                                        <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                        <span class="n">train_batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span>
                                        <span class="n">val_batch_size</span><span class="o">=</span><span class="n">val_batch_size</span><span class="p">,</span>
                                        <span class="n">distributed_sampler</span><span class="o">=</span><span class="n">distributed_sampler</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ClassificationTestDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.ClassificationTestDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">ClassificationTestDatasetInterface</span><span class="p">(</span><span class="n">TestDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">trainset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))),</span>
                                                  <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">))))</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassificationTestDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trainset</span><span class="o">=</span><span class="n">trainset</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
                                                                 <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span></div>


<div class="viewcode-block" id="SegmentationTestDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.SegmentationTestDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">SegmentationTestDatasetInterface</span><span class="p">(</span><span class="n">TestDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">trainset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))),</span>
                                                  <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))))</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">SegmentationTestDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trainset</span><span class="o">=</span><span class="n">trainset</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span></div>


<div class="viewcode-block" id="DetectionTestDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DetectionTestDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">DetectionTestDatasetInterface</span><span class="p">(</span><span class="n">TestDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">image_size</span><span class="o">=</span><span class="mi">320</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">trainset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))),</span>
                                                  <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">6</span><span class="p">))))</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">DetectionTestDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trainset</span><span class="o">=</span><span class="n">trainset</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
                                                            <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestYoloDetectionDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.TestYoloDetectionDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">TestYoloDetectionDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    note: the output size is (batch_size, 6) in the test while in real training</span>
<span class="sd">    the size of axis 0 can vary (the number of bounding boxes)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">input_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">*</span><span class="n">input_dims</span><span class="p">)),</span>
                                                       <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span></div>


<div class="viewcode-block" id="ImageNetDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.ImageNetDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">ImageNetDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/data/Imagenet&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ImageNetDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">dataset_params</span><span class="p">[</span><span class="s1">&#39;dataset_dir&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dataset_dir&#39;</span> <span class="ow">in</span> <span class="n">dataset_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">data_dir</span>
        <span class="n">traindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">data_dir</span><span class="p">),</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
        <span class="n">valdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
        <span class="n">img_mean</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_mean&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">])</span>
        <span class="n">img_std</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_std&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
        <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">img_mean</span><span class="p">,</span>
                                         <span class="n">std</span><span class="o">=</span><span class="n">img_std</span><span class="p">)</span>

        <span class="n">crop_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;crop_size&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mi">224</span><span class="p">)</span>
        <span class="n">resize_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;resize_size&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">color_jitter</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;color_jitter&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">imagenet_pca_aug</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;imagenet_pca_aug&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">train_interpolation</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;train_interpolation&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
        <span class="n">rand_augment_config_string</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;rand_augment_config_string&#39;</span><span class="p">,</span>
                                                          <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">color_jitter</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">color_jitter</span><span class="p">),)</span> <span class="o">*</span> <span class="mi">3</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color_jitter</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">else</span> <span class="n">color_jitter</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_jitter</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;color_jitter must be a scalar or tuple of len 3 or 4&quot;</span>

        <span class="n">color_augmentation</span> <span class="o">=</span> <span class="n">datasets_utils</span><span class="o">.</span><span class="n">get_color_augmentation</span><span class="p">(</span><span class="n">rand_augment_config_string</span><span class="p">,</span> <span class="n">color_jitter</span><span class="p">,</span>
                                                                   <span class="n">crop_size</span><span class="o">=</span><span class="n">crop_size</span><span class="p">,</span> <span class="n">img_mean</span><span class="o">=</span><span class="n">img_mean</span><span class="p">)</span>

        <span class="n">train_transformation_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">RandomResizedCropAndInterpolation</span><span class="p">(</span><span class="n">crop_size</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">train_interpolation</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
            <span class="n">color_augmentation</span><span class="p">,</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">Lighting</span><span class="p">(</span><span class="n">imagenet_pca_aug</span><span class="p">),</span>
            <span class="n">normalize</span><span class="p">]</span>

        <span class="n">rndm_erase_prob</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;random_erase_prob&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rndm_erase_prob</span><span class="p">:</span>
            <span class="n">train_transformation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomErase</span><span class="p">(</span><span class="n">rndm_erase_prob</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">random_erase_value</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">traindir</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">train_transformation_list</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">valdir</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">resize_size</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">crop_size</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">normalize</span><span class="p">,</span>
        <span class="p">]))</span></div>


<div class="viewcode-block" id="TinyImageNetDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.TinyImageNetDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">TinyImageNetDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{},</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/data/TinyImagenet&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TinyImageNetDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="n">data_dir</span> <span class="o">=</span> <span class="n">dataset_params</span><span class="p">[</span><span class="s1">&#39;dataset_dir&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dataset_dir&#39;</span> <span class="ow">in</span> <span class="n">dataset_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">data_dir</span>
        <span class="n">traindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">data_dir</span><span class="p">),</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
        <span class="n">valdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>

        <span class="n">img_mean</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_mean&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="p">[</span><span class="mf">0.4802</span><span class="p">,</span> <span class="mf">0.4481</span><span class="p">,</span> <span class="mf">0.3975</span><span class="p">])</span>
        <span class="n">img_std</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;img_std&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2770</span><span class="p">,</span> <span class="mf">0.2691</span><span class="p">,</span> <span class="mf">0.2821</span><span class="p">])</span>
        <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">img_mean</span><span class="p">,</span>
                                         <span class="n">std</span><span class="o">=</span><span class="n">img_std</span><span class="p">)</span>

        <span class="n">crop_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;crop_size&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mi">56</span><span class="p">)</span>
        <span class="n">resize_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;resize_size&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span>
            <span class="n">traindir</span><span class="p">,</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">crop_size</span><span class="p">),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                <span class="n">normalize</span><span class="p">,</span>
            <span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">valdir</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">resize_size</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">crop_size</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">normalize</span><span class="p">,</span>
        <span class="p">]))</span></div>


<div class="viewcode-block" id="ClassificationDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.ClassificationDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">ClassificationDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalization_mean</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">normalization_std</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                 <span class="n">dataset_params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassificationDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="n">data_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">dataset_dir</span>

        <span class="n">traindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">data_dir</span><span class="p">),</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
        <span class="n">valdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
        <span class="n">normalize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">normalization_mean</span><span class="p">,</span>
                                         <span class="n">std</span><span class="o">=</span><span class="n">normalization_std</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span>
            <span class="n">traindir</span><span class="p">,</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                <span class="n">normalize</span><span class="p">,</span>
            <span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">valdir</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">resolution</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">normalize</span><span class="p">,</span>
        <span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalization_mean</span> <span class="o">=</span> <span class="n">normalization_mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalization_std</span> <span class="o">=</span> <span class="n">normalization_std</span></div>


<div class="viewcode-block" id="PascalVOC2012SegmentationDataSetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.PascalVOC2012SegmentationDataSetInterface">[docs]</a><span class="k">class</span> <span class="nc">PascalVOC2012SegmentationDataSetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache_images</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="n">dataset_params</span><span class="p">[</span><span class="s1">&#39;dataset_dir&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dataset_dir&#39;</span> <span class="ow">in</span> <span class="n">dataset_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> \
            <span class="k">else</span> <span class="s1">&#39;/data/pascal_voc_2012/VOCdevkit/VOC2012/&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">PascalVOC2012SegmentationDataSet</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
                                                         <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;ImageSets/Segmentation/train.txt&#39;</span><span class="p">,</span>
                                                         <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;JPEGImages&#39;</span><span class="p">,</span>
                                                         <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;SegmentationClass&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                         <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
                                                         <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">PascalVOC2012SegmentationDataSet</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
                                                       <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;ImageSets/Segmentation/val.txt&#39;</span><span class="p">,</span>
                                                       <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;JPEGImages&#39;</span><span class="p">,</span>
                                                       <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;SegmentationClass&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                       <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
                                                       <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>


<div class="viewcode-block" id="PascalAUG2012SegmentationDataSetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.PascalAUG2012SegmentationDataSetInterface">[docs]</a><span class="k">class</span> <span class="nc">PascalAUG2012SegmentationDataSetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache_images</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="n">dataset_params</span><span class="p">[</span><span class="s1">&#39;dataset_dir&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dataset_dir&#39;</span> <span class="ow">in</span> <span class="n">dataset_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> \
            <span class="k">else</span> <span class="s1">&#39;/data/pascal_voc_2012/VOCaug/dataset/&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">PascalAUG2012SegmentationDataSet</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;trainval.txt&#39;</span><span class="p">,</span>
            <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;img&#39;</span><span class="p">,</span>
            <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">PascalAUG2012SegmentationDataSet</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;val.txt&#39;</span><span class="p">,</span>
            <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;img&#39;</span><span class="p">,</span>
            <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span> <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>


<div class="viewcode-block" id="CoCoDataSetInterfaceBase"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.CoCoDataSetInterfaceBase">[docs]</a><span class="k">class</span> <span class="nc">CoCoDataSetInterfaceBase</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="n">dataset_params</span><span class="p">[</span><span class="s1">&#39;dataset_dir&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;dataset_dir&#39;</span> <span class="ow">in</span> <span class="n">dataset_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;/data/coco/&#39;</span></div>


<div class="viewcode-block" id="CoCoSegmentationDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.CoCoSegmentationDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">CoCoSegmentationDatasetInterface</span><span class="p">(</span><span class="n">CoCoDataSetInterfaceBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cache_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">dataset_classes_inclusion_tuples_list</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">CoCoSegmentationDataSet</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;instances_train2017.json&#39;</span><span class="p">,</span>
            <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;images/train2017&#39;</span><span class="p">,</span>
            <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;annotations&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">dataset_classes_inclusion_tuples_list</span><span class="o">=</span><span class="n">dataset_classes_inclusion_tuples_list</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">CoCoSegmentationDataSet</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;instances_val2017.json&#39;</span><span class="p">,</span>
            <span class="n">samples_sub_directory</span><span class="o">=</span><span class="s1">&#39;images/val2017&#39;</span><span class="p">,</span>
            <span class="n">targets_sub_directory</span><span class="o">=</span><span class="s1">&#39;annotations&#39;</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">dataset_classes_inclusion_tuples_list</span><span class="o">=</span><span class="n">dataset_classes_inclusion_tuples_list</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coco_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>


<div class="viewcode-block" id="CityscapesDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.CityscapesDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">CityscapesDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cache_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="n">root_dir</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;dataset_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;/data/cityscapes&quot;</span><span class="p">)</span>
        <span class="n">img_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;img_size&quot;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="n">crop_size</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;crop_size&quot;</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
        <span class="n">image_mask_transforms</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;image_mask_transforms&quot;</span><span class="p">)</span>
        <span class="n">image_mask_transforms_aug</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;image_mask_transforms_aug&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">CityscapesDataset</span><span class="p">(</span>
            <span class="n">root_dir</span><span class="o">=</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;lists/train.lst&#39;</span><span class="p">,</span>
            <span class="n">labels_csv_path</span><span class="o">=</span><span class="s2">&quot;lists/labels.csv&quot;</span><span class="p">,</span>
            <span class="n">img_size</span><span class="o">=</span><span class="n">img_size</span><span class="p">,</span>
            <span class="n">crop_size</span><span class="o">=</span><span class="n">crop_size</span><span class="p">,</span>
            <span class="n">augment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">image_mask_transforms</span><span class="o">=</span><span class="n">image_mask_transforms</span><span class="p">,</span>
            <span class="n">image_mask_transforms_aug</span><span class="o">=</span><span class="n">image_mask_transforms_aug</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">CityscapesDataset</span><span class="p">(</span>
            <span class="n">root_dir</span><span class="o">=</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;lists/val.lst&#39;</span><span class="p">,</span>
            <span class="n">labels_csv_path</span><span class="o">=</span><span class="s2">&quot;lists/labels.csv&quot;</span><span class="p">,</span>
            <span class="n">img_size</span><span class="o">=</span><span class="n">img_size</span><span class="p">,</span>
            <span class="n">crop_size</span><span class="o">=</span><span class="n">crop_size</span><span class="p">,</span>
            <span class="n">augment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">image_mask_transforms</span><span class="o">=</span><span class="n">image_mask_transforms</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>


<div class="viewcode-block" id="SuperviselyPersonsDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.SuperviselyPersonsDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">SuperviselyPersonsDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cache_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>
        <span class="n">root_dir</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;dataset_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;/data/supervisely-persons&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">SuperviselyPersonsDataset</span><span class="p">(</span>
            <span class="n">root_dir</span><span class="o">=</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;train.csv&#39;</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">image_mask_transforms_aug</span><span class="o">=</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;image_mask_transforms_aug&quot;</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([])),</span>
            <span class="n">augment</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">SuperviselyPersonsDataset</span><span class="p">(</span>
            <span class="n">root_dir</span><span class="o">=</span><span class="n">root_dir</span><span class="p">,</span>
            <span class="n">list_file</span><span class="o">=</span><span class="s1">&#39;val.csv&#39;</span><span class="p">,</span>
            <span class="n">dataset_hyper_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">,</span>
            <span class="n">cache_labels</span><span class="o">=</span><span class="n">cache_labels</span><span class="p">,</span>
            <span class="n">cache_images</span><span class="o">=</span><span class="n">cache_images</span><span class="p">,</span>
            <span class="n">image_mask_transforms</span><span class="o">=</span><span class="n">get_param</span><span class="p">(</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;image_mask_transforms&quot;</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([])),</span>
            <span class="n">augment</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span></div>


<div class="viewcode-block" id="DetectionDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DetectionDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">DetectionDatasetInterface</span><span class="p">(</span><span class="n">DatasetInterface</span><span class="p">):</span>
<div class="viewcode-block" id="DetectionDatasetInterface.build_data_loaders"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.DetectionDatasetInterface.build_data_loaders">[docs]</a>    <span class="k">def</span> <span class="nf">build_data_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">test_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed_sampler</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

        <span class="n">train_sampler</span> <span class="o">=</span> <span class="n">InfiniteSampler</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">train_batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">train_sampler</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="p">,</span>
                                       <span class="n">batch_sampler</span><span class="o">=</span><span class="n">train_batch_sampler</span><span class="p">,</span>
                                       <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                       <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_reset_seed</span><span class="p">,</span>
                                       <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_collate_fn</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">distributed_sampler</span><span class="p">:</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">DistributedSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">)</span>

        <span class="n">val_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valset</span><span class="p">,</span>
                                                 <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                                 <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
                                                 <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_batch_size</span><span class="p">,</span>
                                                 <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_collate_fn</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">val_loader</span> <span class="o">=</span> <span class="n">val_loader</span></div></div>


<div class="viewcode-block" id="PascalVOCUnifiedDetectionDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.PascalVOCUnifiedDetectionDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">PascalVOCUnifiedDetectionDatasetInterface</span><span class="p">(</span><span class="n">DetectionDatasetInterface</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">data_dir</span>
        <span class="n">train_input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_image_size</span><span class="p">)</span>
        <span class="n">val_input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_image_size</span><span class="p">)</span>
        <span class="n">train_max_num_samples</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;train_max_num_samples&quot;</span><span class="p">)</span>
        <span class="n">val_max_num_samples</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;val_max_num_samples&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">download</span><span class="p">:</span>
            <span class="n">PascalVOCDetectionDataset</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>

        <span class="n">train_dataset_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;train2007&quot;</span><span class="p">,</span> <span class="s2">&quot;val2007&quot;</span><span class="p">,</span> <span class="s2">&quot;train2012&quot;</span><span class="p">,</span> <span class="s2">&quot;val2012&quot;</span><span class="p">]</span>
        <span class="c1"># We divide train_max_num_samples between the datasets</span>
        <span class="k">if</span> <span class="n">train_max_num_samples</span><span class="p">:</span>
            <span class="n">max_num_samples_per_train_dataset</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train_max_num_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset_names</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_num_samples_per_train_dataset</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset_names</span><span class="p">)</span>
        <span class="n">train_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">PascalVOCDetectionDataset</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
                                                <span class="n">input_dim</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span>
                                                <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_train_images</span><span class="p">,</span>
                                                <span class="n">cache_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">+</span> <span class="s2">&quot;cache_train&quot;</span><span class="p">,</span>
                                                <span class="n">transforms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_transforms</span><span class="p">,</span>
                                                <span class="n">images_sub_directory</span><span class="o">=</span><span class="s1">&#39;images/&#39;</span> <span class="o">+</span> <span class="n">trainset_name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
                                                <span class="n">class_inclusion_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">class_inclusion_list</span><span class="p">,</span>
                                                <span class="n">max_num_samples</span><span class="o">=</span><span class="n">max_num_samples_per_train_dataset</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">trainset_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dataset_names</span><span class="p">)]</span>

        <span class="n">testset2007</span> <span class="o">=</span> <span class="n">PascalVOCDetectionDataset</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
                                                <span class="n">input_dim</span><span class="o">=</span><span class="n">val_input_dim</span><span class="p">,</span>
                                                <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_val_images</span><span class="p">,</span>
                                                <span class="n">cache_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">+</span> <span class="s2">&quot;cache_valid&quot;</span><span class="p">,</span>
                                                <span class="n">transforms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_transforms</span><span class="p">,</span>
                                                <span class="n">images_sub_directory</span><span class="o">=</span><span class="s1">&#39;images/test2007/&#39;</span><span class="p">,</span>
                                                <span class="n">class_inclusion_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">class_inclusion_list</span><span class="p">,</span>
                                                <span class="n">max_num_samples</span><span class="o">=</span><span class="n">val_max_num_samples</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">train_sets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">ConcatDataset</span><span class="p">(</span><span class="n">train_sets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">testset2007</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">collate_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_collate_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">img_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_image_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span><span class="o">.</span><span class="n">cache_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_train_images</span></div>


<div class="viewcode-block" id="CoCoDetectionDatasetInterface"><a class="viewcode-back" href="../../../../../super_gradients.training.datasets.dataset_interfaces.html#super_gradients.training.CoCoDetectionDatasetInterface">[docs]</a><span class="k">class</span> <span class="nc">CoCoDetectionDatasetInterface</span><span class="p">(</span><span class="n">DetectionDatasetInterface</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_params</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CoCoDetectionDatasetInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset_params</span><span class="o">=</span><span class="n">dataset_params</span><span class="p">)</span>

        <span class="n">train_input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_image_size</span><span class="p">)</span>
        <span class="n">targets_format</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s2">&quot;targets_format&quot;</span><span class="p">,</span> <span class="n">DetectionTargetsFormat</span><span class="o">.</span><span class="n">LABEL_CXCYWH</span><span class="p">)</span>

        <span class="n">train_transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">DetectionMosaic</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span>
                                            <span class="n">prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">mosaic_prob</span><span class="p">),</span>
                            <span class="n">DetectionRandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">degrees</span><span class="p">,</span>
                                                  <span class="n">translate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">translate</span><span class="p">,</span>
                                                  <span class="n">scales</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">mosaic_scale</span><span class="p">,</span>
                                                  <span class="n">shear</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span>
                                                  <span class="n">target_size</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span>
                                                  <span class="n">filter_box_candidates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">filter_box_candidates</span><span class="p">,</span>
                                                  <span class="n">wh_thr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">wh_thr</span><span class="p">,</span>
                                                  <span class="n">area_thr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">area_thr</span><span class="p">,</span>
                                                  <span class="n">ar_thr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">ar_thr</span>
                                                  <span class="p">),</span>
                            <span class="n">DetectionMixup</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span>
                                           <span class="n">mixup_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">mixup_scale</span><span class="p">,</span>
                                           <span class="n">prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">mixup_prob</span><span class="p">,</span>
                                           <span class="n">flip_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">flip_prob</span><span class="p">),</span>
                            <span class="n">DetectionHSV</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">hsv_prob</span><span class="p">,</span>
                                         <span class="n">hgain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">hgain</span><span class="p">,</span>
                                         <span class="n">sgain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">sgain</span><span class="p">,</span>
                                         <span class="n">vgain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">vgain</span>
                                         <span class="p">),</span>
                            <span class="n">DetectionHorizontalFlip</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">flip_prob</span><span class="p">),</span>
                            <span class="n">DetectionPaddedRescale</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span> <span class="n">max_targets</span><span class="o">=</span><span class="mi">120</span><span class="p">),</span>
                            <span class="n">DetectionTargetsFormatTransform</span><span class="p">(</span><span class="n">output_format</span><span class="o">=</span><span class="n">targets_format</span><span class="p">)</span>
                            <span class="p">]</span>

        <span class="c1"># IF CACHE- CREATING THE CACHE FILE WILL HAPPEN ONLY FOR RANK 0, THEN ALL THE OTHER RANKS SIMPLY READ FROM IT.</span>
        <span class="n">local_rank</span> <span class="o">=</span> <span class="n">get_local_rank</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">wait_for_the_master</span><span class="p">(</span><span class="n">local_rank</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trainset</span> <span class="o">=</span> <span class="n">COCODetectionDataset</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
                                                 <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_subdir</span><span class="p">,</span>
                                                 <span class="n">json_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">train_json_file</span><span class="p">,</span>
                                                 <span class="n">img_size</span><span class="o">=</span><span class="n">train_input_dim</span><span class="p">,</span>
                                                 <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_train_images</span><span class="p">,</span>
                                                 <span class="n">cache_dir_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_dir_path</span><span class="p">,</span>
                                                 <span class="n">transforms</span><span class="o">=</span><span class="n">train_transforms</span><span class="p">,</span>
                                                 <span class="n">with_crowd</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">val_input_dim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_image_size</span><span class="p">)</span>
        <span class="n">with_crowd</span> <span class="o">=</span> <span class="n">core_utils</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="p">,</span> <span class="s1">&#39;with_crowd&#39;</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># IF CACHE- CREATING THE CACHE FILE WILL HAPPEN ONLY FOR RANK 0, THEN ALL THE OTHER RANKS SIMPLY READ FROM IT.</span>
        <span class="k">with</span> <span class="n">wait_for_the_master</span><span class="p">(</span><span class="n">local_rank</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valset</span> <span class="o">=</span> <span class="n">COCODetectionDataset</span><span class="p">(</span>
                <span class="n">data_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
                <span class="n">json_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_json_file</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">val_subdir</span><span class="p">,</span>
                <span class="n">img_size</span><span class="o">=</span><span class="n">val_input_dim</span><span class="p">,</span>
                <span class="n">transforms</span><span class="o">=</span><span class="p">[</span><span class="n">DetectionPaddedRescale</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">val_input_dim</span><span class="p">),</span>
                            <span class="n">DetectionTargetsFormatTransform</span><span class="p">(</span><span class="n">max_targets</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">targets_format</span><span class="p">)],</span>
                <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_val_images</span><span class="p">,</span>
                <span class="n">cache_dir_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_params</span><span class="o">.</span><span class="n">cache_dir_path</span><span class="p">,</span>
                <span class="n">with_crowd</span><span class="o">=</span><span class="n">with_crowd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">COCO_DETECTION_CLASSES_LIST</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, SuperGradients team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>